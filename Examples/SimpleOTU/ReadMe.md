# iCAMP analysis example: SimpleOTU

## 1. System requirements

1.1- Operating systems: Windows, or Mac, or Linux, any versions which can run R (version >= 3.2).

1.2- Dependencis: R (version >=3.2; https://www.r-project.org/), R packages: vegan, parallel, permute, ape, bigmemory.

1.3- iCAMP current version 1.1.3 has been tested on R 3.5.3, R3.6.2, and R4.0.0. 

1.4- Any required non-standard hardware: No.

## 2. Installation guide

2.1- Downlaod and install R (https://www.r-project.org/).

2.2- Install iCAMP.

- Install published iCAMP: Open R, use function "install.packages" as below.

```
install.packages("iCAMP")
```

- Install another version:
  - Download an iCAMP version from this repository iCAMP1/RPackage/AllVersions.
  - Open R, click Packages/install package from local file, then select the file. For windows, select the .zip file. For Mac/Linux, select the .gz file.
  Alternatively, in Linux sytem, if you open R in a terminal, use following command to install from the .gz file (revise "/Path/to/the/folder" to the real path of this folder on your computer, revise "xxx" to the version number of iCAMP):
```
install.packages(pkgs="/Path/to/the/folder/iCAMP_xxx.tar.gz", repos = NULL, type="source")
```

2.3- In R, install or update following packages:
vegan, parallel, permute, ape, bigmemory.
2.4- The whole installation typically takes several minutes. Usually, <5 min for R installation, <1 min for the iCAMP package, <2 min for installation of other packages.

3- Demo
3.1- Please check the icamp.test.r in the example folder, and follow the detailed instruction in the file to run iCAMP analysis for the example data.
3.2- Expected output: example output files have been saved in the subfolder "TestOutputs11". Detailed explanation can also be found in the file "icamp.test.r".
Output files:
(1) path.rda: a R object to list all the nodes and  edge lengthes from root to every tip. saved in R data format. an intermediate output when claculating phylogenetic distance matrix.
(2) pd.bin: BIN file (backingfile) generated by function big.matrix in R package bigmemory. This is the big matrix storing pairwise phylogenetic distance values. By using this bigmemory format file, we will not need memory but hard disk when calling big matrix for calculation.
(3) pd.desc: the DESC file (descriptorfile) to hold the backingfile (pd.bin) description.
(4) pd.taxon.name.csv: comma delimited csv file storing the IDs of tree tips (OTUs), serving as the row/column names of the big phylogenetic distance matrix.
(5) ND.res.rda: a R object to save all the output of function "dniche" (niche differences among taxa). 
(6) nd.names.csv: comma delimited csv file storing the IDs of species (OTUs), serving as the row/column names of the big niche difference matrix.
(7) pH.ND.bin: BIN file (backingfile) generated from "dniche" by funciton big.matrix in R package bigmemory. This is the big matrix storing pairwise niche difference values based on pH values in environment.txt.
(8) pH.ND.desc: the DESC file (descriptorfile) to hold the backingfile (pH.ND.bin) description.
(9) temperature.ND.bin: BIN file (backingfile) generated from "dniche", storing pairwise niche difference values based on temperature values in environment.txt.
(10) temperature.ND.desc: the DESC file (descriptorfile) to hold the backingfile (temperature.ND.bin) description.
(11) Test.PhyloSignalSummary.csv: a table to summarize within-bin phylogenetic signal test results from "ps.bin". The indexes include relative abundance of bins with significant phylogenetic signal in all bins (RAsig) or in bins with species number larger than min.spn (RAsig.adj), average correlation coefficient in significant bins (MeanR.sig) or in all bins (MeanR).
(12) Test.PhyloSignalDetail.csv: a table to list all the correlation coefficient (r) and p value in each bin.
(13) Test.OmitBinInform.csv: a table about relative abundances of species in the small bins which have too few members and will be omitted if setting omit.option as omit.
(14) Test.iCAMP.detail.rda: the object "icres" saved in R data format. it is a list object. The first element bNRIiRCa is the result of relative importance of each assembly process in each pairwise comparison (each turnover). The second element "detail" including binning information (named taxabin), phylogenetic and taxonomic metrics results in each bin (named like bNRIi, RCa, etc.), relative abundance of each bin (bin.weight), relative importance of each process in each turnover between communities (processes), input settings (setting), and input community data matrix (comm). See help document of the function icamp.big for more details.
(15) Test.iCAMP.Summary.rda: the object "icbin" saved in R data format. see help document of the function icamp.bins for description of each element in the object.
(16) Test.ProcessImportance_EachGroup.csv: Relative importance of each process in governing the turnovers in a group of samples.
(17) Test.ProcessImportance_EachBin_EachGroup.csv: Relative importance of each process in governing the turnovers of each bin among a group of samples.
(18) Test.ProcessImportance_EachTurnover.csv: Relative importance of each process in governing the turnovers between each pair of communities (samples).
(19) Test.BinContributeToProcess_EachGroup.csv: Bin contribution to each process, measuring the contribution of each bin to the relative importance of each process in the assembly of a group of communities.
(20) Test.iCAMP.Boot.Management.rda: the object "icboot" saved in R data format. see help document of the function icamp.boot for description of each element in the object.
(21) Test.BootSummary.Management.csv: a table to summarize bootstrapping results. see help document of the function icamp.boot for description of the output element "summary".
(22) Test.Compare.Management.csv: a table to summarize comparison index, effect size, and significance between each two groups. see help document of the function icamp.boot for description of the output element "compare".

3.3- Expected run time: 1 to 3 min in a normal desktop computer.

4- Instractions for use
To analyze your own data with iCAMP, please
(1) Check the format of the example data files (otu.txt, tree.nwk, treat2col.txt, and environment.txt) in the folder "Example". Revise your data files to the same format. It is fine if you do not have environment factor information, just pay attention to the notes in the "icamp.test.r" specific to no env.file situation.
(2) Change the folder paths and file names in the "icamp.test.r" as indicated. 
(3) Change the thread number for parallel computing, memory limitation, and other parameter setting according to your need. You may check the help document of each function for detailed explanation.
(4) Run the codes and check the output files in the output folder you've specified.
